import numpy as np


def masi_entropy(thresholds, prob):
    r = -1
    # print(prob)
    thresholds.insert(0, 0)
    thresholds.append(256)
    # print(thresholds)
    classes = len(thresholds) - 1
    # print(classes)
    w = {}
    output = {}
    for i in range(classes):
        if thresholds[i+1] == 256:
            w_values = w.values()
            s = 0
            for value in w_values:
                s += value
            w_gen = 1 - s
        else:
            w_gen = np.sum(prob[thresholds[i]:thresholds[i+1]])
        w["w"+str(i)] = w_gen
    # print(w)
        out = 0
        # print(w)
        if w_gen > 0:
            for j in range(thresholds[i], thresholds[i+1]):
                if prob[j] > 0:
                    out = out+(prob[j]/w["w"+str(i)]) * \
                        np.log(prob[j]/w["w"+str(i)])
            output["out"+str(i)] = out
    # print(output)
    src = {}
    for i in range(0, classes):
        src["class"+str(i)] = (1/(1-r)) * \
            (np.log(1-(1-r)*(output["out"+str(i)])))
    # print(src)
    src_classes = src.values()
    print(src_classes)
    src_total = 0
    for src_values in src_classes:
        src_total += src_values
    return src_total


thresholds = [97, 164]
print(masi_entropy(thresholds, prob))

prob = [0.0,0.0,0.0,0.0,
0.0,
 0.0,
 0.0,
 0.0,
 0.0,
 0.0,
 0.0,
 0.0,
 0.0,
 0.0,
 0.0,
 0.0,
 0.0,
 0.0,
 0.0,
 0.0,
 0.0,
 0.0,
 0.0,
 0.0,
 0.0,
 3.814697265625e-06,
 2.288818359375e-05,
 7.62939453125e-05,
 0.000110626220703125,
 0.000225067138671875,
 0.000370025634765625,
 0.000522613525390625,
 0.000690460205078125,
 0.0008392333984375,
 0.0011444091796875,
 0.001605987548828125,
 0.0019073486328125,
 0.002338409423828125,
 0.002899169921875,
 0.0035858154296875,
 0.004047393798828125,
 0.00478363037109375,
 0.00550079345703125,
 0.006282806396484375,
 0.00672149658203125,
 0.007175445556640625,
 0.00762176513671875,
 0.007984161376953125,
 0.0077056884765625,
 0.008022308349609375,
 0.00795745849609375,
 0.007747650146484375,
 0.007549285888671875,
 0.006893157958984375,
 0.0066070556640625,
 0.0063629150390625,
 0.00601959228515625,
 0.005603790283203125,
 0.0048675537109375,
 0.00472259521484375,
 0.0046539306640625,
 0.003810882568359375,
 0.00356292724609375,
 0.003719329833984375,
 0.003360748291015625,
 0.003391265869140625,
 0.003017425537109375,
 0.00304412841796875,
 0.002941131591796875,
 0.002971649169921875,
 0.0032501220703125,
 0.0031280517578125,
 0.003170013427734375,
 0.00299835205078125,
 0.00334930419921875,
 0.003467559814453125,
 0.003314971923828125,
 0.003253936767578125,
 0.003612518310546875,
 0.0037078857421875,
 0.003459930419921875,
 0.003482818603515625,
 0.0032958984375,
 0.003566741943359375,
 0.00356292724609375,
 0.003688812255859375,
 0.003849029541015625,
 0.003875732421875,
 0.00405120849609375,
 0.0043182373046875,
 0.004283905029296875,
 0.0045318603515625,
 0.0046539306640625,
 0.005046844482421875,
 0.005344390869140625,
 0.00586700439453125,
 0.006175994873046875,
 0.00689697265625,
 0.00713348388671875,
 0.007961273193359375,
 0.00722503662109375,
 0.0073699951171875,
 0.0074615478515625,
 0.0070037841796875,
 0.00672149658203125,
 0.006595611572265625,
 0.0061492919921875,
 0.0057373046875,
 0.00547027587890625,
 0.005214691162109375,
 0.00519561767578125,
 0.005126953125,
 0.005130767822265625,
 0.005535125732421875,
 0.00518035888671875,
 0.0051727294921875,
 0.005279541015625,
 0.005523681640625,
 0.005977630615234375,
 0.0059967041015625,
 0.0061187744140625,
 0.006778717041015625,
 0.006931304931640625,
 0.007221221923828125,
 0.007740020751953125,
 0.008167266845703125,
 0.0087890625,
 0.008853912353515625,
 0.009033203125,
 0.00962066650390625,
 0.00879669189453125,
 0.0087890625,
 0.0085906982421875,
 0.00792694091796875,
 0.007598876953125,
 0.00695037841796875,
 0.007373809814453125,
 0.007259368896484375,
 0.007724761962890625,
 0.008148193359375,
 0.008625030517578125,
 0.008785247802734375,
 0.008876800537109375,
 0.009357452392578125,
 0.009380340576171875,
 0.009185791015625,
 0.0085296630859375,
 0.0088348388671875,
 0.008724212646484375,
 0.00829315185546875,
 0.008708953857421875,
 0.0088348388671875,
 0.009124755859375,
 0.009899139404296875,
 0.010250091552734375,
 0.010471343994140625,
 0.010303497314453125,
 0.009746551513671875,
 0.009197235107421875,
 0.008625030517578125,
 0.007785797119140625,
 0.0070648193359375,
 0.0067901611328125,
 0.006160736083984375,
 0.005619049072265625,
 0.005435943603515625,
 0.005157470703125,
 0.00470733642578125,
 0.00478363037109375,
 0.004558563232421875,
 0.00446319580078125,
 0.004608154296875,
 0.00511932373046875,
 0.004817962646484375,
 0.004703521728515625,
 0.00441741943359375,
 0.00452423095703125,
 0.004673004150390625,
 0.004138946533203125,
 0.003597259521484375,
 0.003452301025390625,
 0.00313568115234375,
 0.002994537353515625,
 0.002628326416015625,
 0.002323150634765625,
 0.00240325927734375,
 0.0024566650390625,
 0.00258636474609375,
 0.002422332763671875,
 0.002529144287109375,
 0.002819061279296875,
 0.003032684326171875,
 0.00316619873046875,
 0.003589630126953125,
 0.003452301025390625,
 0.00372314453125,
 0.003509521484375,
 0.00347137451171875,
 0.003215789794921875,
 0.00313568115234375,
 0.00331878662109375,
 0.00344085693359375,
 0.00318145751953125,
 0.00337982177734375,
 0.0034637451171875,
 0.00370025634765625,
 0.003726959228515625,
 0.004062652587890625,
 0.00397491455078125,
 0.004077911376953125,
 0.0036468505859375,
 0.00374603271484375,
 0.00363922119140625,
 0.003299713134765625,
 0.002658843994140625,
 0.0020751953125,
 0.001873016357421875,
 0.001499176025390625,
 0.001453399658203125,
 0.0010833740234375,
 0.00087738037109375,
 0.00089263916015625,
 0.000743865966796875,
 0.0007171630859375,
 0.000476837158203125,
 0.000293731689453125,
 0.00028228759765625,
 0.000225067138671875,
 0.000194549560546875,
 8.392333984375e-05,
 7.2479248046875e-05,
 3.4332275390625e-05,
 2.6702880859375e-05,
 2.288818359375e-05,
 3.0517578125e-05,
 3.814697265625e-06,
 0.0,
 0.0,
 3.814697265625e-06,
 0.0,
 0.0,
 0.0,
 7.62939453125e-06,
 0.0,
 3.814697265625e-06,
 3.814697265625e-06,
 0.0,
 0.0,
 0.0,
 0.0,
 0.0,
 0.0,
 0.0,
 0.0,
 0.0,
 0.0]